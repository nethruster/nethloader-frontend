<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,minimum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Nethloader</title>

    <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png?v=YAoGY2Yjjx">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png?v=YAoGY2Yjjx">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png?v=YAoGY2Yjjx">
    <link rel="manifest" href="/assets/favicons/manifest.json?v=YAoGY2Yjjx">
    <link rel="mask-icon" href="/assets/favicons/safari-pinned-tab.svg?v=YAoGY2Yjjx" color="#1e87f0">
    <link rel="shortcut icon" href="/assets/favicons/favicon.ico?v=YAoGY2Yjjx">
    <meta name="msapplication-config" content="/assets/favicons/browserconfig.xml?v=YAoGY2Yjjx">
    <meta name="theme-color" content="#1e87f0">

    <!-- Define global config -->
    <script src='/assets/app.config.js'></script>
    <script src='/assets/locale.js'></script>

    <link rel="stylesheet" href="/assets/css/css-reset.css">
    <link rel="stylesheet" href="/assets/css/css-utils.css">
</head>
<body>
    <div id="nethloader" role="main" class='flex'>
        <div class="loading">
            <!-- View-loading styles -->
            <style>
                .loading {
                    flex: 1;
                }

                .loader {
                    position: relative;
                    max-width: 40px;
                    width: 34px;
                    flex: 5;

                    margin: 0 auto;
                }

                .loader:before {
                    content: '';
                    display: block;

                    padding-top: 100%;
                }

                .loader svg { width: auto; }

                .circular {
                    position: absolute;
                    top: 0;
                    bottom: 0;
                    left: 0;
                    right: 0;
                    width: 100%;
                    height: 100%;

                    margin: auto;

                    animation: rotate 2s linear infinite;        
                    transform-origin: center center;
                }

                .path {
                    stroke-dasharray: 1, 200;
                    stroke-dashoffset: 0;
                    animation: dash 1.5s ease-in-out infinite;
                    stroke: #1e87f0;
                    stroke-linecap: round;
                }

                @keyframes rotate {
                    100% { transform: rotate(360deg); }
                }

                @keyframes dash {
                    0% {
                        stroke-dasharray: 1, 200;
                        stroke-dashoffset: 0;
                    }
                    50% {
                        stroke-dasharray: 89, 200;
                        stroke-dashoffset: -35px;
                    }
                    100% {
                        stroke-dasharray: 89, 200;
                        stroke-dashoffset: -124px;
                    }
                }
            </style>
            <div class='loader flex flex-full-center'>
                <svg class='circular' viewBox='25 25 50 50'>
                    <circle class='path' cx='50' cy='50' r='20' fill='none' stroke-width='2' stroke-miterlimit='10'
                    />
                </svg>
            </div>
        </div>
    </div>
        <script>
            var checkBrowserIntegrity = function () {
                // Required ES6 API detection
                try {
                    var promiseTest = Promise
                    var fetchTest = fetch
                } catch (err) {
                    console.error('This browser doesn\'t support Promises or any ES6 new syntax and features. Consider upgrading.')
                    throw Error('this browser doesn\'t support required web technology. Consider upgrading to a newer browser like Google Chrome, Firefox or MS Edge.')
                }

                // Private mode (localstorage, sessionStorage... access) detection
                try {
                    var localStTest = window.localStorage
                    var sessionStTest = window.sessionStorage
                } catch (err) {
                    console.error('Nethloader relies heavily on browser data APIs like localStorage, sessionStorage, please enable them to use the app.')
                    throw Error('Nethloader relies heavily on browser data APIs, please enable cookies and browser data to enjoy the app properly.')
                }
            }
            // Simple feature check to prevent some browsers from hurting themselves and others around them
            try {
                checkBrowserIntegrity()
            } catch (err) {
                // I don't use template string to maximize compatibility
                document.body.firstChild.innerHTML = '<div id="wtf-gtfo" class="wtf-gtfo flex flex-full-center flex-dc" style="width:100vw;height:100vh;"><a href="https://github.com/nethruster/nethloader"><img alt="Nethloader Logo" width="150" src="/assets/img/logo.svg" /></a><p>This domain is using <a href="https://github.com/nethruster/nethloader">Nethloader</a>, a self hosted media sharing service.</p><span>Unfortunately, ' + err.message + '</span></div>'
            }
        </script>
</body>
</html>
